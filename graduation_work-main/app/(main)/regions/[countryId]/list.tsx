//–õ–µ—Ä–∞

"use client"; 
// ‚¨ÖÔ∏è –¶–µ–π —Ñ–∞–π–ª –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—ñ (React / Next.js client-side)

// ---------------------- –Ü–º–ø–æ—Ä—Ç–∏ ----------------------
import { regions } from "@/db/schema"; 
// ‚¨ÖÔ∏è –°—Ö–µ–º–∞ —Ç–∞–±–ª–∏—Ü—ñ regions –∑ –ë–î (–¥–ª—è —Ç–∏–ø—ñ–≤)

import { RegionCard } from "./card"; 
// ‚¨ÖÔ∏è UI-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∫–∞—Ä—Ç–∫–∏ —Ä–µ–≥—ñ–æ–Ω—É

import { useRouter } from "next/navigation"; 
// ‚¨ÖÔ∏è –•—É–∫ –¥–ª—è –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó –ø–æ —Å—Ç–æ—Ä—ñ–Ω–∫–∞—Ö

import { useTransition } from "react"; 
// ‚¨ÖÔ∏è –•—É–∫ –¥–ª—è –∫–µ—Ä—É–≤–∞–Ω–Ω—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∏–º–∏ –ø–µ—Ä–µ—Ö–æ–¥–∞–º–∏ –±–µ–∑ –±–ª–æ–∫—É–≤–∞–Ω–Ω—è UI

import { upsertUserProgressRegion } from "@/actions/user-progress"; 
// ‚¨ÖÔ∏è –°–µ—Ä–≤–µ—Ä–Ω–∞ action –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –ø—Ä–æ–≥—Ä–µ—Å—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —Ç—É—Ç, –∞–ª–µ –º–æ–∂–ª–∏–≤–æ –¥–ª—è –º–∞–π–±—É—Ç–Ω—å–æ—ó —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó)

import { toast } from "sonner"; 
// ‚¨ÖÔ∏è –ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ –¥–ª—è —Å–ø–æ–≤—ñ—â–µ–Ω—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

// ---------------------- –¢–∏–ø–∏ Props ----------------------
type Props = {
  regions: typeof regions.$inferSelect[]; 
  // ‚¨ÖÔ∏è –ú–∞—Å–∏–≤ —Ä–µ–≥—ñ–æ–Ω—ñ–≤ –∑ —Ç–∏–ø–∞–º–∏ —ñ–∑ —Å—Ö–µ–º–∏ –ë–î
  activeRegionId: number | null; 
  // ‚¨ÖÔ∏è ID –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Ä–µ–≥—ñ–æ–Ω—É, —è–∫–∏–π –∑–∞—Ä–∞–∑ –≤–∏–±—Ä–∞–Ω–æ (–∞–±–æ null)
};

// ---------------------- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç RegionsList ----------------------
export const RegionsList = ({ regions, activeRegionId }: Props) => {
  const router = useRouter(); 
  // ‚¨ÖÔ∏è –•—É–∫ –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–Ω–æ—ó –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó

  const [pending, startTransition] = useTransition(); 
  // ‚¨ÖÔ∏è pending = true, –∫–æ–ª–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ –¥—ñ—è –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è
  // startTransition = —Ñ—É–Ω–∫—Ü—ñ—è –¥–ª—è –æ–±–≥–æ—Ä—Ç–∞–Ω–Ω—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∏—Ö –∑–º—ñ–Ω —Å—Ç–∞–Ω—É/–Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó

  // ---------------------- –û–±—Ä–æ–±–Ω–∏–∫ –∫–ª—ñ–∫—É ----------------------
  const onClick = (id: number) => {
    if (pending) return; 
    // ‚¨ÖÔ∏è –Ø–∫—â–æ –≤–∂–µ –π–¥–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ –¥—ñ—è ‚Üí –±–ª–æ–∫—É—î–º–æ –ø–æ–≤—Ç–æ—Ä–Ω—ñ –∫–ª—ñ–∫–∏

    if (id === activeRegionId) {
      router.push("/learn"); 
      // ‚¨ÖÔ∏è –Ø–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∫–ª—ñ–∫–Ω—É–≤ –Ω–∞ –ø–æ—Ç–æ—á–Ω–∏–π –∞–∫—Ç–∏–≤–Ω–∏–π —Ä–µ–≥—ñ–æ–Ω ‚Üí –ø–µ—Ä–µ—Ö–æ–¥–∏–º–æ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫—É –Ω–∞–≤—á–∞–Ω–Ω—è
      return;
    }

    // üîπ –¢—É—Ç –º–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ –≤–∏–∫–ª–∏–∫ upsertUserProgressRegion(id)
    // startTransition(() => upsertUserProgressRegion(id))
    //   .then(() => router.push(`/regions/${id}`))
    //   .catch(err => toast.error("–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∑–º—ñ–Ω—ñ —Ä–µ–≥—ñ–æ–Ω—É"));
  };

  // ---------------------- –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è ----------------------
  return (
    <div className="grid grid-cols-2 gap-4">
      {/* ‚¨ÖÔ∏è –°—ñ—Ç–∫–∞ 2 –∫–æ–ª–æ–Ω–∫–∏ –∑ –≤—ñ–¥—Å—Ç—É–ø–∞–º–∏ */}
      {regions.map(region => (
        <RegionCard
          key={region.id} 
          // ‚¨ÖÔ∏è –£–Ω—ñ–∫–∞–ª—å–Ω–∏–π –∫–ª—é—á –¥–ª—è React
          id={region.id} 
          // ‚¨ÖÔ∏è –ü–µ—Ä–µ–¥–∞—î–º–æ ID —Ä–µ–≥—ñ–æ–Ω—É
          title={region.title} 
          // ‚¨ÖÔ∏è –ù–∞–∑–≤–∞ —Ä–µ–≥—ñ–æ–Ω—É –Ω–∞ –∫–∞—Ä—Ç—Ü—ñ
          onClick={onClick} 
          // ‚¨ÖÔ∏è –§—É–Ω–∫—Ü—ñ—è –ø—Ä–∏ –∫–ª—ñ–∫—É
          disabled={pending} 
          // ‚¨ÖÔ∏è –ë–ª–æ–∫—É—î–º–æ, —è–∫—â–æ –π–¥–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ –¥—ñ—è
          active={region.id === activeRegionId} 
          // ‚¨ÖÔ∏è –ê–∫—Ç–∏–≤–Ω–∞ –∫–∞—Ä—Ç–∫–∞ = –≤–∏–¥—ñ–ª–µ–Ω–Ω—è –≥–∞–ª–æ—á–∫–æ—é –∞–±–æ —Å—Ç–∏–ª–µ–º
        />
      ))}
    </div>
  );
};
